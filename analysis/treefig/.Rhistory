scale_x_continuous(limits = c(-2500, 2400)) +
theme_tree() +
coord_flip()
#p1 <- rotate_tree(p1, 90)
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
ggsave('treefigure.png', p1, width=12, height=6)
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=2000, hjust=0, angle=45) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-4500, 2400)) +
theme_tree() +
coord_flip()
#p1 <- rotate_tree(p1, 90)
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
ggsave('treefigure.png', p1, width=12, height=6)
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=2000, hjust=0, angle=45) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(1, 100)) +
theme_tree() +
coord_flip()
#p1 <- rotate_tree(p1, 90)
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=2000, hjust=0, angle=45) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(1, 100)) +
theme_tree() +
coord_flip()
#p1 <- rotate_tree(p1, 90)
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=2000, hjust=0, angle=45) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(1, 1000)) +
theme_tree() +
coord_flip()
#p1 <- rotate_tree(p1, 90)
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=2000, hjust=0, angle=45) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(0, 1)) +
theme_tree() +
coord_flip()
#p1 <- rotate_tree(p1, 90)
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=2000, hjust=0, angle=45) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(0, 100)) +
theme_tree() +
coord_flip()
#p1 <- rotate_tree(p1, 90)
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=2000, hjust=0, angle=45) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(0, 600)) +
theme_tree() +
coord_flip()
#p1 <- rotate_tree(p1, 90)
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=2000, hjust=0, angle=45) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(0, 20)) +
theme_tree() +
coord_flip()
#p1 <- rotate_tree(p1, 90)
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=2000, hjust=0, angle=45) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(-10, 20)) +
theme_tree() +
coord_flip()
#p1 <- rotate_tree(p1, 90)
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=2000, hjust=0, angle=90) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(-10, 20)) +
theme_tree() +
coord_flip()
#p1 <- rotate_tree(p1, 90)
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
ggsave('treefigure.png', p1)
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=1800, hjust=0, angle=90) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(-10, 20)) +
theme_tree() +
coord_flip()
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=1600, hjust=0, angle=90) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(-10, 20)) +
theme_tree() +
coord_flip()
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=1300, hjust=0, angle=90) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(-10, 20)) +
theme_tree() +
coord_flip()
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=1380, hjust=0, angle=90) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 2400)) +
scale_y_continuous(limits = c(-10, 20)) +
theme_tree() +
coord_flip()
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=1370, hjust=0, angle=90) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 1800)) +
scale_y_continuous(limits = c(-10, 20)) +
theme_tree() +
coord_flip()
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=1370, hjust=0, angle=90) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 1600)) +
scale_y_continuous(limits = c(-10, 20)) +
theme_tree() +
coord_flip()
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=3,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1
ggsave('treefigure.png', p1)
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=1370, hjust=0, angle=90) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 1600)) +
scale_y_continuous(limits = c(-10, 20)) +
theme_tree() +
coord_flip()
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=5,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
ggsave('treefigure.png', p1), width=12, height=6)
ggsave('treefigure.png', p1), width=12, height=8)
ggsave('treefigure.png', p1, width=12, height=8)
ggsave('treefigure.png', p1, width=12, height=6)
ggsave('treefigure.png', p1, width=8, height=12)
ggsave('treefigure.png', p1, width=10, height=12)
data.long %>%
select(Language, Variable, State) %>%
mutate(State=factor(State)) %>%
pivot_wider(names_from = Variable, values_from = Change)
data.wide <- data.long %>%
select(Language, Variable, Change) %>%
mutate(State=factor(State)) %>%
pivot_wider(names_from = Variable, values_from = Change) %>%
tibble::column_to_rownames(var="Language")
data.wide <- data.long %>%
select(Language, Variable, Change) %>%
mutate(Change=factor(Change)) %>%
pivot_wider(names_from = Variable, values_from = Change) %>%
tibble::column_to_rownames(var="Language")
data.wide
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=1370, hjust=0, angle=90) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 1600)) +
scale_y_continuous(limits = c(-10, 20)) +
theme_tree() +
coord_flip()
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=5,
colnames_position="bottom"
) +
scale_fill_manual(values=c("#C6E2FF", "dodgerblue4"), na.value="#7A8B8B") +
theme(legend.position="top")
p1 <- ggtree(tree, size=1.2, layout='slanted') +
geom_tiplab(align=TRUE, linesize=0, offset=1370, hjust=0, angle=90) +
geom_label(
aes(label=rposterior), label.size=0.3, na.rm=TRUE, size=2,
nudge_x=-0.4, nudge_y=0
) +
scale_x_continuous(limits = c(-1500, 1600)) +
scale_y_continuous(limits = c(-10, 20)) +
theme_tree() +
coord_flip()
p1 <- revts(p1)
p1 <- gheatmap(
p1,
data.wide,
width=1,
hjust=1,
offset=10,
colnames=TRUE,
font.size=5,
colnames_position="bottom"
) +
scale_fill_manual(values=c(
"#26a69a", # Proto-Panoan
"#f5f5f5", # Absence
"#ffca28", # Gain
"#42a5f5" # Loss
), na.value="white") +
theme(legend.position="top")
ggsave('treefigure-changes.png', p1, width=10, height=12)
p1
